
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Homodyne detection &#8212; Amanuel&#39;s Notebook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'physics/quantum-mechanics/homodyne_detection';</script>
    <link rel="icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Photon number detection" href="photon_number_detection.html" />
    <link rel="prev" title="Gaussian quantum information" href="gaussian_quantum_info.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Amanuel's Notebook</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Physics</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">1. Introduction</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="quantum_mechanics.html">2. Quantum Mechanics</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="entanglement.html">Entanglement</a></li>
<li class="toctree-l2"><a class="reference internal" href="density_matrix.html">Density matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="partial_trace.html">Partial trace</a></li>
<li class="toctree-l2"><a class="reference internal" href="wigner_function.html">Wigner function</a></li>
<li class="toctree-l2"><a class="reference internal" href="gaussian_quantum_info.html">Gaussian quantum information</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Homodyne detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="photon_number_detection.html">Photon number detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="lindblad_eq.html">Lindblad master equation</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Computer Science</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../computerscience/intro.html">3. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../computerscience/data_structs.html">4. Data structures</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../computerscience/algorithms/algorithms.html">5. Algorithms</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../computerscience/algorithms/dynamic_prog.html">Dynamic programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../computerscience/algorithms/divide_conquer.html">Divide and conquer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../computerscience/algorithms/randomized_algos.html">Randomized algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../computerscience/algorithms/graph_algos.html">Graph algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../computerscience/algorithms/max_flow.html">Max flow algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../computerscience/algorithms/np_problems.html">NP-completeness</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../computerscience/algorithms/linear_prog.html">Linear programming</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../computerscience/machine-learning/machine_learning.html">6. Machine Learning</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../computerscience/machine-learning/attention.html">Attention</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Mathematics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../mathematics/intro.html">7. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mathematics/group_theory.html">8. Group theory</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Statistics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../statistics/intro.html">9. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../statistics/inv_trans_sampling.html">10. Inverse transform sampling</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../statistics/bayesian-statistics/bayesian_statistics.html">11. Bayesian Statistics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../statistics/bayesian-statistics/hierarchical_models.html">1. Hierarchical Models</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Back Matter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../backmatter/bibliography.html">12. Bibliography</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/amanuelanteneh/aman-notes" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/amanuelanteneh/aman-notes/issues/new?title=Issue%20on%20page%20%2Fphysics/quantum-mechanics/homodyne_detection.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/physics/quantum-mechanics/homodyne_detection.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Homodyne detection</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#homodyne-detection-in-the-fock-basis">Homodyne detection in the Fock basis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#some-exploration">Some exploration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-calculation">Numerical calculation</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="homodyne-detection">
<h1>Homodyne detection<a class="headerlink" href="#homodyne-detection" title="Link to this heading">#</a></h1>
<p>Homodyne detection is the most common Gaussian measurement used in continuous variable quantum information processing
and it consists of
measuring the position or momentum observables, <span class="math notranslate nohighlight">\(x\)</span> or <span class="math notranslate nohighlight">\(p\)</span> respectively, <span id="id1">[<a class="reference internal" href="../../backmatter/bibliography.html#id5" title="Christian Weedbrook, Stefano Pirandola, Raúl García-Patrón, Nicolas J Cerf, Timothy C Ralph, Jeffrey H Shapiro, and Seth Lloyd. Gaussian quantum information. Reviews of Modern Physics, 84(2):621–669, 2012.">Weedbrook <em>et al.</em>, 2012</a>]</span>.</p>
<section id="homodyne-detection-in-the-fock-basis">
<h2>Homodyne detection in the Fock basis<a class="headerlink" href="#homodyne-detection-in-the-fock-basis" title="Link to this heading">#</a></h2>
<section id="some-exploration">
<h3>Some exploration<a class="headerlink" href="#some-exploration" title="Link to this heading">#</a></h3>
<p>Recall that in the Fock basis a general density matrix <span class="math notranslate nohighlight">\(\rho\)</span> can be expressed as</p>
<div class="math notranslate nohighlight">
\[
\rho = \sum_{n}^\infty\sum_m^\infty\rho_{nm}\ket{n}\bra{m}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho_{nm}\)</span> denotes the element of <span class="math notranslate nohighlight">\(\rho\)</span> in row <span class="math notranslate nohighlight">\(n\)</span> column <span class="math notranslate nohighlight">\(m\)</span>. Also recall that if one has a superposition state <span class="math notranslate nohighlight">\(\ket{\Psi} = \frac{1}{\sqrt{2}}\ket{0} + \frac{1}{\sqrt{2}}\ket{1}\)</span> the corresponding position wave function is given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\Psi(x) =  \braket{x|\Psi} = \frac{1}{\sqrt{2}}\braket{x|0} + \frac{1}{\sqrt{2}}\braket{x|1} \\
\equiv \frac{1}{\sqrt{2}}\psi_0(x) + \frac{1}{\sqrt{2}}\psi_1(x).
\end{split}\]</div>
<p>We can quickly verify that this wave function is normalized by computing</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\int^{\infty}_{-\infty} |\Psi(x)|^2 &amp;=  \int^{\infty}_{-\infty} \left|\frac{1}{\sqrt{2}}\psi_0(x) + \frac{1}{\sqrt{2}}\psi_1(x)\right|^2dx\\
&amp;= \int^{\infty}_{-\infty} \left( \frac{1}{\sqrt{2}} \psi_0(x) + \frac{1}{\sqrt{2}} \psi_1(x)  \right)\left( \frac{1}{\sqrt{2}} \psi_0^*(x) + \frac{1}{\sqrt{2}} \psi_1^*(x)  \right) dx \quad \text{Since $|z|^2=zz^*$} \\
&amp;=  \int^{\infty}_{-\infty} \frac{1}{2} \left(  \psi_0(x) +  \psi_1(x)  \right)\left(  \psi_0^*(x) + \psi_1^*(x)  \right) dx \\
&amp;= \frac{1}{2} \int^{\infty}_{-\infty}  \psi_0(x)\psi_0^*(x) + \psi_0(x)\psi_1^*(x) + \psi_1(x)\psi_0^*(x) + \psi_1(x)\psi_1^*(x)  dx \\
&amp;= \frac{1}{2} \int^{\infty}_{-\infty} |\psi_0(x)|^2 + \psi_0(x)\psi_1^*(x) + \psi_1(x)\psi_0^*(x) + |\psi_1(x)|^2 dx \\
&amp;= \frac{1}{2} \left( \int^{\infty}_{-\infty} |\psi_0(x)|^2 dx + \int^{\infty}_{-\infty} \psi_0(x)\psi_1^*(x) dx + \int^{\infty}_{-\infty} \psi_1(x)\psi_0^*(x) dx + \int^{\infty}_{-\infty} |\psi_1(x)|^2 dx\right) \\
&amp;= \frac{1}{2}(1 + \braket{1|0} + \braket{0|1} + 1)  \quad \text{Since $\int^{\infty}_{-\infty} \psi_n(x)\psi_m^*(x) dx \equiv \braket{m|n} = \braket{n|m}$ and $\psi_1(x)$ and $\psi_0(x)$ are normalized} \\
&amp;= \frac{1}{2}(1 + 0 + 0 + 1) \quad \text{Since $\ket{0}$ and $\ket{1}$ are orthogonal} \\
&amp;= 1.
\end{align}
\end{split}\]</div>
<p>Now what happens if we do</p>
<div class="math notranslate nohighlight">
\[
\bra{x}\rho\ket{x} = \sum_{n}^\infty\sum_m^\infty\rho_{nm}\braket{x|n}\braket{m|x}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho = \ket{\Psi}\bra{\Psi}\)</span> and <span class="math notranslate nohighlight">\(\ket{\Psi}\)</span> is the same as above.</p>
<p>Well the explicit density matrix is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\rho = \ket{\Psi}\bra{\Psi} = \begin{bmatrix}1/2 &amp; 1/2 \\
                                 1/2 &amp; 1/2\end{bmatrix}
\end{split}\]</div>
<p>so we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\bra{x}\rho\ket{x} &amp;= \sum_{n}^\infty\sum_m^\infty\rho_{nm}\braket{x|n}\braket{m|x} \\
&amp;= \frac{1}{2}\braket{x|0}\braket{0|x} + \frac{1}{2}\braket{x|0}\braket{1|x} + \frac{1}{2}\braket{x|1}\braket{0|x} + \frac{1}{2}\braket{x|1}\braket{1|x} \\
&amp;= \frac{1}{2}|\psi_0(x)|^2 + \frac{1}{2}\psi_0(x)\psi_1^*(x) + \frac{1}{2}\psi_1(x)\psi_0^*(x) + \frac{1}{2}|\psi_1(x)|^2 \\
&amp;\text{We can see that this expression is the same as the one in the integrand of Equation 5 from above so we have:}\\
\bra{x}\rho\ket{x}&amp;= \left|\frac{1}{\sqrt{2}}\psi_0(x) + \frac{1}{\sqrt{2}}\psi_1(x)\right|^2 = |\Psi(x)|^2 = p(x)
\end{align*}
\end{split}\]</div>
<p>So it seems like when we take the expectation value of the density operator <span class="math notranslate nohighlight">\(\rho\)</span> with respect to the position eigenstate <span class="math notranslate nohighlight">\(\ket{x}\)</span> we get the probability distribution (PDF) of the state represented by <span class="math notranslate nohighlight">\(\rho\)</span> over <span class="math notranslate nohighlight">\(x\)</span>!</p>
<p>But what if <span class="math notranslate nohighlight">\(\rho\)</span> is a mixed state such as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\rho = \frac{1}{2}\ket{0}\bra{0} + \frac{1}{2}\ket{1}\bra{1} = \begin{bmatrix}1/2 &amp; 0 \\
                                 0 &amp; 1/2\end{bmatrix}
\end{split}\]</div>
<p>we get</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\bra{x}\rho\ket{x} &amp;= \frac{1}{2}\braket{x|0}\braket{0|x} + \frac{1}{2}\braket{x|1}\braket{1|x}\\
&amp;= \frac{1}{2}\psi_0(x)\psi_0^*(x) + \frac{1}{2}\psi_1(x)\psi_1^*(x) \\
&amp;= \frac{1}{2}|\psi_0(x)|^2 + \frac{1}{2}|\psi_1(x)|^2 = p(x)
\end{align*}
\end{split}\]</div>
<p>which is a <em><strong>mixture</strong></em> of two probability distributions, hence why mixed states are also called statistical mixtures I guess!</p>
<p>So it seems like in general we have (and you can probably show this is true for the general case using something like the multinomial theorem)</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
|p(x)|^2 &amp;= \bra{x}\rho\ket{x} \\ 
&amp;= \sum_{n}^\infty\sum_m^\infty\rho_{nm}\braket{x|n}\braket{m|x} \\
&amp;= \sum_{n}^\infty\sum_m^\infty\rho_{nm} \psi_n(x)\psi_m^*(x)
\end{align*}
\end{split}\]</div>
<p>So what if we wanted an expression for the probability distribution of position for a general state written in the Fock basis?
Well we would need the analytic expressions for the wave functions of each of the Fock state <span class="math notranslate nohighlight">\(\ket{n}\)</span>. Since the Fock state <span class="math notranslate nohighlight">\(\ket{n}\)</span> is the <span class="math notranslate nohighlight">\(n\)</span>-th energy eigenstate of the quantum harmonic oscillator it’s wave function is (see <span id="id2">[<a class="reference internal" href="../../backmatter/bibliography.html#id9" title="Mark Beck. Quantum mechanics: theory and experiment. Oxford University Press, USA, 2012.">Beck, 2012</a>]</span> and <span id="id3">[<a class="reference internal" href="../../backmatter/bibliography.html#id8" title="David H McIntyre. Quantum mechanics: A paradigms approach. Cambridge University Press, 2022.">McIntyre, 2022</a>]</span> for detailed derivation)</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\psi_n(x) &amp;=  \left( \frac{m\omega}{\pi \hbar} \right)^{1/4} \frac{1}{\sqrt{2^nn!}} H_n(\xi)e^{-\xi^2/2} \\
&amp;=\left( \frac{1}{\pi} \right)^{1/4} \frac{1}{\sqrt{2^nn!}} H_n(x)e^{-x^2/2}
\end{align*}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\xi = \sqrt{\frac{m\omega}{\hbar}}x = x\)</span> and <span class="math notranslate nohighlight">\(\left(\frac{m\omega}{\pi \hbar} \right)^{1/4} = \left(\frac{1}{\pi} \right)^{1/4}\)</span>, because we are using “natural units” where energy is measured in units of <span class="math notranslate nohighlight">\(\hbar\omega\)</span> and distance in units of <span class="math notranslate nohighlight">\(\sqrt{\frac{\hbar}{m\omega}}\)</span>, and <span class="math notranslate nohighlight">\(H_n(\cdot)\)</span> is the the <span class="math notranslate nohighlight">\(n\)</span>-th physicist’s Hermite polynomial. These wave functions are real so we don’t have to worry too much about the conjugates when we start implementing this in code.</p>
<p>Thus our expression for the probability distribution is now</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
|p(x)|^2 &amp;= \bra{x}\rho\ket{x} \\ 
&amp;= \sum_{n}^\infty\sum_m^\infty\rho_{nm}\braket{x|n}\braket{m|x} \\
&amp;= \sum_{n}^\infty\sum_m^\infty\rho_{nm} \psi_n(x)\psi_m^*(x)\\
&amp;= \sum_{n}^\infty\sum_m^\infty\rho_{nm} \left( \frac{1}{\pi} \right)^{1/2}  \frac{1}{\sqrt{2^{n+m}n!m!}} H_m(x)H_n(x)e^{-x^2}
\end{align*}
\end{split}\]</div>
</section>
<section id="numerical-calculation">
<h3>Numerical calculation<a class="headerlink" href="#numerical-calculation" title="Link to this heading">#</a></h3>
<p>Now lets try to code this up and look at the distributions. We’ll numerically compute the mean and variance of the distributions to make sure they match the analytical value as a check.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">scp</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">hermite</span> <span class="k">as</span> <span class="n">H</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">factorial</span> <span class="k">as</span> <span class="n">fac</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">simpson</span>
<span class="kn">import</span> <span class="nn">qutip</span> <span class="k">as</span> <span class="nn">qt</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">Math</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;text.usetex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">175</span>
<span class="n">font</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;family&#39;</span><span class="p">:</span> <span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">13</span><span class="p">}</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">font</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_pdf</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">state_name</span><span class="p">):</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$x$ probability distribution for &quot;</span> <span class="o">+</span> <span class="n">state_name</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$p(x)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">pdf</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">pdf</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Below we will be computing the probability distribution of a quantum state over the position observable <span class="math notranslate nohighlight">\(x\)</span>. It is important to note that since <span class="math notranslate nohighlight">\(x\)</span> is a continuous random variable what we will be computing is a probability <em>density</em> function meaning <span class="math notranslate nohighlight">\(p(x)\)</span> is the probability <em>density</em> at <span class="math notranslate nohighlight">\(x\)</span> not the probability of the random variable taking on the value of <span class="math notranslate nohighlight">\(x\)</span>. For discrete random variables like the photon number observable <span class="math notranslate nohighlight">\(N\)</span> what we would have is a probability <em>mass</em> function, <span class="math notranslate nohighlight">\(P(N)\)</span>, and <span class="math notranslate nohighlight">\(P(N)\)</span> in that case <em>does</em> correspond to the probability of the discrete random variable taking on the value of <span class="math notranslate nohighlight">\(N\)</span>.
Note that the sum of variable <code class="docutils literal notranslate"><span class="pre">pdf</span></code> should <em>not</em> be equal to 1 in general since these are probability <em>densities</em> and therefore it is the integral of this function that should be equal to 1.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dim</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">fock</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">hbar</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">state_name</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$|\psi\rangle=|&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fock</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;\rangle$&quot;</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="n">qt</span><span class="o">.</span><span class="n">fock_dm</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">fock</span><span class="p">)</span> <span class="p">)</span>
<span class="n">m_w_over_pi_hbar</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">hbar</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">num_points</span> <span class="o">=</span> <span class="mi">750</span>
<span class="n">x_max</span> <span class="o">=</span> <span class="mi">7</span>

<span class="n">points</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">x_max</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">num_points</span><span class="p">)</span>
<span class="n">pdf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">num_points</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rho</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rho</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">pdf</span> <span class="o">+=</span> <span class="n">rho</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="n">m</span><span class="p">))</span> <span class="o">*</span> <span class="n">fac</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="n">fac</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">H</span><span class="p">(</span><span class="n">m</span><span class="p">)(</span><span class="n">points</span><span class="p">)</span> <span class="o">*</span> <span class="n">H</span><span class="p">(</span><span class="n">n</span><span class="p">)(</span><span class="n">points</span><span class="p">)</span> 

<span class="n">pdf</span> <span class="o">*=</span>  <span class="n">m_w_over_pi_hbar</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">points</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">pdf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">pdf</span><span class="p">)</span> <span class="c1"># imaginary parts should have all canceled but still need to cast to real data type</span>
<span class="n">pdf</span><span class="p">[</span><span class="n">pdf</span> <span class="o">&lt;</span> <span class="mf">1e-10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># zero out any super small or negative probabilities</span>

<span class="c1"># Note also that we should NOT have to normalize this unless the integral is much lower than 1</span>
<span class="n">integral</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">simpson</span><span class="p">(</span><span class="n">pdf</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">points</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">mean</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span> <span class="n">simpson</span><span class="p">(</span><span class="n">points</span><span class="o">*</span><span class="n">pdf</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">points</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">var</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span> <span class="n">simpson</span><span class="p">((</span> <span class="p">(</span><span class="n">points</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">pdf</span> <span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">points</span> <span class="p">),</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">Math</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\int^{\infty}_{-\infty} p(x)dx \approx &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">integral</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1"> \mu_x = \int^{\infty}_{-\infty} xp(x)dx \approx &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span> \
             <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; </span><span class="se">\\</span><span class="s1"> \sigma_x^2 = \int^{\infty}_{-\infty} (x-\mu_x)^2p(x)dx \approx &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">var</span><span class="p">)</span> <span class="p">))</span>

<span class="n">plot_pdf</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">state_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \int^{\infty}_{-\infty} p(x)dx \approx 1.0\\ \mu_x = \int^{\infty}_{-\infty} xp(x)dx \approx -0.0 \\ \sigma_x^2 = \int^{\infty}_{-\infty} (x-\mu_x)^2p(x)dx \approx 0.5\end{split}\]</div>
<img alt="../../_images/8eac3a462ddff7dd087d1e181f49eb692177ab516610b9da71e1def99ec0f5f9.png" src="../../_images/8eac3a462ddff7dd087d1e181f49eb692177ab516610b9da71e1def99ec0f5f9.png" />
</div>
</div>
<div class="dropdown admonition note">
<p class="admonition-title">Note</p>
<p>Note that we use <span class="math notranslate nohighlight">\(\approx\)</span> because we use a numerical method (simpsons rule) to compute these integrals and we are only working with discrete values of the function.</p>
</div>
<p>Now lets check using the analytic expression of the probability density function for the Fock states i.e</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fock_prob_dist</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">hbar</span><span class="p">):</span>
    <span class="n">pdf</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="n">n</span><span class="p">)(</span><span class="n">points</span><span class="p">)</span> <span class="o">*</span> <span class="n">H</span><span class="p">(</span><span class="n">n</span><span class="p">)(</span><span class="n">points</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">points</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> 
    <span class="n">pdf</span> <span class="o">*=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">hbar</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="n">fac</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">pdf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">pdf</span><span class="p">)</span> <span class="c1"># imaginary parts should have all canceled but still need to cast to real data type</span>
    <span class="n">pdf</span><span class="p">[</span><span class="n">pdf</span> <span class="o">&lt;</span> <span class="mf">1e-10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># zero out any super small or negative probabilities</span>
    <span class="k">return</span> <span class="n">pdf</span>

<span class="n">true_pdf</span> <span class="o">=</span> <span class="n">fock_prob_dist</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">fock</span><span class="p">,</span> <span class="n">hbar</span><span class="p">)</span>
<span class="c1"># note that we should NOT have to normalize this unless the integral is much lower than 1</span>
<span class="n">integral</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">true_pdf</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">points</span><span class="p">)</span>
<span class="n">mean</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span> <span class="n">simpson</span><span class="p">(</span><span class="n">points</span><span class="o">*</span><span class="n">pdf</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">points</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">var</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span> <span class="n">simpson</span><span class="p">((</span> <span class="p">(</span><span class="n">points</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">pdf</span> <span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">points</span> <span class="p">),</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">Math</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\int^{\infty}_{-\infty} p(x)dx \approx &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">integral</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1"> \mu_x = \int^{\infty}_{-\infty} xp(x)dx \approx &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span> \
             <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; </span><span class="se">\\</span><span class="s1"> \sigma_x^2 = \int^{\infty}_{-\infty} (x-\mu_x)^2p(x)dx \approx &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">var</span><span class="p">)</span> <span class="p">))</span>

<span class="n">plot_pdf</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">true_pdf</span><span class="p">,</span> <span class="n">state_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \int^{\infty}_{-\infty} p(x)dx \approx 0.9999999999811167\\ \mu_x = \int^{\infty}_{-\infty} xp(x)dx \approx -0.0 \\ \sigma_x^2 = \int^{\infty}_{-\infty} (x-\mu_x)^2p(x)dx \approx 0.5\end{split}\]</div>
<img alt="../../_images/8eac3a462ddff7dd087d1e181f49eb692177ab516610b9da71e1def99ec0f5f9.png" src="../../_images/8eac3a462ddff7dd087d1e181f49eb692177ab516610b9da71e1def99ec0f5f9.png" />
</div>
</div>
<p>Looks like they match! Now just to be safe let’s check that this works for a super position state and a mixed state.</p>
<p>First the superposition <span class="math notranslate nohighlight">\(\ket{\psi} = \frac{1}{\sqrt{2}}\ket{2} + \frac{1}{\sqrt{2}}\ket{6}\)</span>, we’ll also use <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> to vectorize the computation</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fock1</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">fock2</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">state_name</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$|\psi\rangle=\frac</span><span class="si">{1}</span><span class="s2">{\sqrt</span><span class="si">{2}</span><span class="s2">}|&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fock1</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;\rangle$ + &quot;</span> <span class="o">+</span>  <span class="sa">r</span><span class="s2">&quot;$\frac</span><span class="si">{1}</span><span class="s2">{\sqrt</span><span class="si">{2}</span><span class="s2">}|&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fock2</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;\rangle$&quot;</span>
<span class="n">psi</span> <span class="o">=</span> <span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">fock</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">fock1</span><span class="p">)</span> <span class="o">+</span> <span class="n">qt</span><span class="o">.</span><span class="n">fock</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">fock2</span><span class="p">))</span><span class="o">.</span><span class="n">unit</span><span class="p">()</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="n">qt</span><span class="o">.</span><span class="n">ket2dm</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span> <span class="p">)</span>

<span class="c1"># pre-compute the Hermite polynomial function values times the prefactor that has n! and m!</span>
<span class="n">H_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">rho</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rho</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>  <span class="n">num_points</span><span class="p">))</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rho</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rho</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">H_mat</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="n">m</span><span class="p">))</span> <span class="o">*</span> <span class="n">fac</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="n">fac</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">H</span><span class="p">(</span><span class="n">m</span><span class="p">)(</span><span class="n">points</span><span class="p">)</span> <span class="o">*</span> <span class="n">H</span><span class="p">(</span><span class="n">n</span><span class="p">)(</span><span class="n">points</span><span class="p">)</span>

<span class="c1"># numpy vectorization to avoid for-loops</span>
<span class="n">dist_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">H_mat</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">pdf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dist_mat</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="n">pdf</span> <span class="o">*=</span>  <span class="n">m_w_over_pi_hbar</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">points</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">pdf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">pdf</span><span class="p">)</span> <span class="c1"># imaginary parts should have all canceled but still need to cast to real data type</span>
<span class="n">pdf</span><span class="p">[</span><span class="n">pdf</span> <span class="o">&lt;</span> <span class="mf">1e-10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># zero out any super small or negative probabilities</span>

<span class="c1"># note that we should NOT have to normalize this unless the integral is much lower than 1</span>
<span class="n">integral</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">pdf</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">points</span><span class="p">)</span>
<span class="n">mean</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span> <span class="n">simpson</span><span class="p">(</span><span class="n">points</span><span class="o">*</span><span class="n">pdf</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">points</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">var</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span> <span class="n">simpson</span><span class="p">((</span> <span class="p">(</span><span class="n">points</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">pdf</span> <span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">points</span> <span class="p">),</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">Math</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\int^{\infty}_{-\infty} p(x)dx \approx &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">integral</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1"> \mu_x = \int^{\infty}_{-\infty} xp(x)dx \approx &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span> \
             <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; </span><span class="se">\\</span><span class="s1"> \sigma_x^2 = \int^{\infty}_{-\infty} (x-\mu_x)^2p(x)dx \approx &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">var</span><span class="p">)</span> <span class="p">))</span>

<span class="n">plot_pdf</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">state_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \int^{\infty}_{-\infty} p(x)dx \approx 0.9999999999828573\\ \mu_x = \int^{\infty}_{-\infty} xp(x)dx \approx -0.0 \\ \sigma_x^2 = \int^{\infty}_{-\infty} (x-\mu_x)^2p(x)dx \approx 4.5\end{split}\]</div>
<img alt="../../_images/cba37cb6b5c236b3c8a4f8ddf5131fb379c1e6192de3e71ebd2394dca5f111fb.png" src="../../_images/cba37cb6b5c236b3c8a4f8ddf5131fb379c1e6192de3e71ebd2394dca5f111fb.png" />
</div>
</div>
<div class="dropdown admonition note">
<p class="admonition-title">Note</p>
<p>Note the use of <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> vectorization to save time. Instead of computing the the Hermite polynomial values at each <span class="math notranslate nohighlight">\(x\)</span> point in double nested for-loops we can just store and save those in a matrix <code class="docutils literal notranslate"><span class="pre">H_mat</span></code> of size (dim, dim, num_points) = (40, 40, 750). We then use <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> functions
<code class="docutils literal notranslate"><span class="pre">dist_mat</span> <span class="pre">=</span> <span class="pre">np.expand_dims(rho,</span> <span class="pre">-1)</span> <span class="pre">*</span> <span class="pre">np.expand_dims(H_mat,</span> <span class="pre">0)</span></code> and <code class="docutils literal notranslate"><span class="pre">pdf</span> <span class="pre">=</span> <span class="pre">np.sum(dist_mat,</span> <span class="pre">axis=(1,</span> <span class="pre">2)).flatten()</span></code> to avoid having to use a nested for-loop to multiply each element of <code class="docutils literal notranslate"><span class="pre">H_mat</span></code> by each entry of <code class="docutils literal notranslate"><span class="pre">rho</span></code>.</p>
</div>
<p>The true probability density function is given by</p>
<div class="math notranslate nohighlight">
\[
p(x) = |\braket{x|\psi}|^2 = \frac{1}{2}\left(\psi_2(x)\psi_2^*(x) + \psi_2(x)\psi_6^*(x) + \psi_6(x)\psi_2^*(x) + \psi_6(x)\psi_6^*(x)\right)
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fock_superpos_prob_dist</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">hbar</span><span class="p">):</span>
    <span class="n">psi1</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="n">n1</span><span class="p">)(</span><span class="n">points</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">points</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">psi1</span> <span class="o">*=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">hbar</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.25</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">n1</span><span class="p">)</span> <span class="o">*</span> <span class="n">fac</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span> <span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">psi2</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="n">n2</span><span class="p">)(</span><span class="n">points</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">points</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">psi2</span> <span class="o">*=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">hbar</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.25</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">n2</span><span class="p">)</span> <span class="o">*</span> <span class="n">fac</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span> <span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">pdf</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span> <span class="n">psi1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">psi1</span><span class="o">*</span><span class="n">psi2</span> <span class="o">+</span> <span class="n">psi2</span><span class="o">*</span><span class="n">psi1</span> <span class="o">+</span> <span class="n">psi2</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>
    <span class="n">pdf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">pdf</span><span class="p">)</span> <span class="c1"># imaginary parts should have all canceled but still need to cast to real data type</span>
    <span class="n">pdf</span><span class="p">[</span><span class="n">pdf</span> <span class="o">&lt;</span> <span class="mf">1e-10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># zero out any super small or negative probabilities</span>
    <span class="k">return</span> <span class="n">pdf</span>

<span class="n">true_pdf</span> <span class="o">=</span> <span class="n">fock_superpos_prob_dist</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">fock1</span><span class="p">,</span> <span class="n">fock2</span><span class="p">,</span> <span class="n">hbar</span><span class="p">)</span>
<span class="c1"># note that we should NOT have to normalize this unless the integral is much lower than 1</span>
<span class="n">integral</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">true_pdf</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">points</span><span class="p">)</span>
<span class="n">mean</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span> <span class="n">simpson</span><span class="p">(</span><span class="n">points</span><span class="o">*</span><span class="n">true_pdf</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">points</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">var</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span> <span class="n">simpson</span><span class="p">((</span> <span class="p">(</span><span class="n">points</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">true_pdf</span> <span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">points</span> <span class="p">),</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">Math</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\int^{\infty}_{-\infty} p(x)dx \approx &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">integral</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1"> \mu_x = \int^{\infty}_{-\infty} xp(x)dx \approx &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span> \
             <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; </span><span class="se">\\</span><span class="s1"> \sigma_x^2 = \int^{\infty}_{-\infty} (x-\mu_x)^2p(x)dx \approx &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">var</span><span class="p">)</span> <span class="p">))</span>

<span class="n">plot_pdf</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">true_pdf</span><span class="p">,</span> <span class="n">state_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \int^{\infty}_{-\infty} p(x)dx \approx 0.9999999999828576\\ \mu_x = \int^{\infty}_{-\infty} xp(x)dx \approx -0.0 \\ \sigma_x^2 = \int^{\infty}_{-\infty} (x-\mu_x)^2p(x)dx \approx 4.5\end{split}\]</div>
<img alt="../../_images/cba37cb6b5c236b3c8a4f8ddf5131fb379c1e6192de3e71ebd2394dca5f111fb.png" src="../../_images/cba37cb6b5c236b3c8a4f8ddf5131fb379c1e6192de3e71ebd2394dca5f111fb.png" />
</div>
</div>
<p>Alright those match as well so now lets do the mixed state <span class="math notranslate nohighlight">\(\rho = \frac{1}{2}\ket{2}\bra{2} + \frac{1}{2}\ket{6}\bra{6}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">state_name</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$\rho=\frac</span><span class="si">{1}{2}</span><span class="s2">|&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fock1</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;\rangle\langle$&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fock1</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;$|$&quot;</span> \
             <span class="o">+</span> <span class="s2">&quot; + &quot;</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;$\frac</span><span class="si">{1}{2}</span><span class="s2">|&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fock2</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;\rangle\langle$&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fock2</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;$|$&quot;</span>

<span class="n">rho</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">fock_dm</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">fock1</span><span class="p">)</span> <span class="o">+</span>  <span class="n">qt</span><span class="o">.</span><span class="n">fock_dm</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">fock2</span><span class="p">)</span>
<span class="n">rho</span> <span class="o">/=</span> <span class="n">rho</span><span class="o">.</span><span class="n">tr</span><span class="p">()</span> <span class="c1"># normalize state</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="n">rho</span> <span class="p">)</span>

<span class="n">dist_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">H_mat</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">pdf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dist_mat</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="n">pdf</span> <span class="o">*=</span>  <span class="n">m_w_over_pi_hbar</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">points</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">pdf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">pdf</span><span class="p">)</span> <span class="c1"># imaginary parts should have all canceled but still need to cast to real data type</span>
<span class="n">pdf</span><span class="p">[</span><span class="n">pdf</span> <span class="o">&lt;</span> <span class="mf">1e-10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># zero out any super small or negative probabilities</span>

<span class="c1"># note that we should NOT have to normalize this unless the integral is much lower than 1</span>
<span class="n">integral</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">pdf</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">points</span><span class="p">)</span>
<span class="n">mean</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span> <span class="n">simpson</span><span class="p">(</span><span class="n">points</span><span class="o">*</span><span class="n">pdf</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">points</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">var</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span> <span class="n">simpson</span><span class="p">((</span> <span class="p">(</span><span class="n">points</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">pdf</span> <span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">points</span> <span class="p">),</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">Math</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\int^{\infty}_{-\infty} p(x)dx \approx &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">integral</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1"> \mu_x = \int^{\infty}_{-\infty} xp(x)dx \approx &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span> \
             <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; </span><span class="se">\\</span><span class="s1"> \sigma_x^2 = \int^{\infty}_{-\infty} (x-\mu_x)^2p(x)dx \approx &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">var</span><span class="p">)</span> <span class="p">))</span>

<span class="n">plot_pdf</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">state_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \int^{\infty}_{-\infty} p(x)dx \approx 0.9999999999829643\\ \mu_x = \int^{\infty}_{-\infty} xp(x)dx \approx -0.0 \\ \sigma_x^2 = \int^{\infty}_{-\infty} (x-\mu_x)^2p(x)dx \approx 4.5\end{split}\]</div>
<img alt="../../_images/8a793e3d38149cb85c2aa5e0eaabbf9b0badc340f5d7716a96103824c0ff3495.png" src="../../_images/8a793e3d38149cb85c2aa5e0eaabbf9b0badc340f5d7716a96103824c0ff3495.png" />
</div>
</div>
<p>The true probability density function will be a mixture of the the PDF’s for <span class="math notranslate nohighlight">\(\ket{2}\)</span> and <span class="math notranslate nohighlight">\(\ket{6}\)</span> so</p>
<div class="math notranslate nohighlight">
\[
p(x) = \frac{1}{2}|\psi_2(x)|^2 + \frac{1}{2}|\psi_6(x)|^2
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fock_mixture_prob_dist</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">hbar</span><span class="p">):</span>
    <span class="n">psi1</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="n">n1</span><span class="p">)(</span><span class="n">points</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">points</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">psi1</span> <span class="o">*=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">hbar</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.25</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">n1</span><span class="p">)</span> <span class="o">*</span> <span class="n">fac</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span> <span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">psi2</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="n">n2</span><span class="p">)(</span><span class="n">points</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">points</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">psi2</span> <span class="o">*=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">hbar</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.25</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">n2</span><span class="p">)</span> <span class="o">*</span> <span class="n">fac</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span> <span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">pdf</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span> <span class="n">psi1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">psi2</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>
    <span class="n">pdf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">pdf</span><span class="p">)</span> <span class="c1"># imaginary parts should have all canceled but still need to cast to real data type</span>
    <span class="n">pdf</span><span class="p">[</span><span class="n">pdf</span> <span class="o">&lt;</span> <span class="mf">1e-10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># zero out any super small or negative probabilities</span>
    <span class="k">return</span> <span class="n">pdf</span>

<span class="n">true_pdf</span> <span class="o">=</span> <span class="n">fock_mixture_prob_dist</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">fock1</span><span class="p">,</span> <span class="n">fock2</span><span class="p">,</span> <span class="n">hbar</span><span class="p">)</span>

<span class="c1"># note that we should NOT have to normalize this unless the integral is much lower than 1</span>
<span class="n">integral</span> <span class="o">=</span> <span class="n">simpson</span><span class="p">(</span><span class="n">true_pdf</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">points</span><span class="p">)</span>
<span class="n">mean</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span> <span class="n">simpson</span><span class="p">(</span><span class="n">points</span><span class="o">*</span><span class="n">true_pdf</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">points</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">var</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span> <span class="n">simpson</span><span class="p">((</span> <span class="p">(</span><span class="n">points</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">true_pdf</span> <span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">points</span> <span class="p">),</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">Math</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\int^{\infty}_{-\infty} p(x)dx \approx &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">integral</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1"> \mu_x = \int^{\infty}_{-\infty} xp(x)dx \approx &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span> \
             <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; </span><span class="se">\\</span><span class="s1"> \sigma_x^2 = \int^{\infty}_{-\infty} (x-\mu_x)^2p(x)dx \approx &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">var</span><span class="p">)</span> <span class="p">))</span>

<span class="n">plot_pdf</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">true_pdf</span><span class="p">,</span> <span class="n">state_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \int^{\infty}_{-\infty} p(x)dx \approx 0.9999999999829644\\ \mu_x = \int^{\infty}_{-\infty} xp(x)dx \approx -0.0 \\ \sigma_x^2 = \int^{\infty}_{-\infty} (x-\mu_x)^2p(x)dx \approx 4.5\end{split}\]</div>
<img alt="../../_images/8a793e3d38149cb85c2aa5e0eaabbf9b0badc340f5d7716a96103824c0ff3495.png" src="../../_images/8a793e3d38149cb85c2aa5e0eaabbf9b0badc340f5d7716a96103824c0ff3495.png" />
</div>
</div>
<p>Boom. We have found a way to compute the probability distribution of the state over <span class="math notranslate nohighlight">\(x\)</span>. To find the probability distribution of the momentum <span class="math notranslate nohighlight">\(p\)</span> we can just rotate the initial state by <span class="math notranslate nohighlight">\(\frac{\pi}{2}\)</span></p>
<div class="math notranslate nohighlight">
\[
\ket{\tilde{\psi}} = e^{i\frac{\pi}{2}a^\dagger a}\ket{\psi},
\]</div>
<p>as this is the Fourier transform that will move into momentum space, before computing the PDF.</p>
<p>Now that we have the PDF we may sample from it to simulate measurements of the desired quadrature!</p>
<p>Oddly it seems like <code class="docutils literal notranslate"><span class="pre">strawberryfields</span></code> in it’s code treats the PDF that it computes <span class="math notranslate nohighlight">\(|\Psi(x)|^2\)</span> as a PMF which I don’t think works…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> watermark
<span class="o">%</span><span class="k">watermark</span> -n -u -v -iv
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Last updated: Sat Jul 06 2024

Python implementation: CPython
Python version       : 3.10.12
IPython version      : 8.22.2

qutip     : 4.7.5
numpy     : 1.26.2
scipy     : 1.12.0
matplotlib: 3.7.4
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./physics/quantum-mechanics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="gaussian_quantum_info.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Gaussian quantum information</p>
      </div>
    </a>
    <a class="right-next"
       href="photon_number_detection.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Photon number detection</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#homodyne-detection-in-the-fock-basis">Homodyne detection in the Fock basis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#some-exploration">Some exploration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-calculation">Numerical calculation</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Amanuel Anteneh
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>